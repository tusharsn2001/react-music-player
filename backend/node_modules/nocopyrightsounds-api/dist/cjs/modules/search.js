'use strict'
var __importDefault =
    (this && this.__importDefault) ||
    function (mod) {
        return mod && mod.__esModule ? mod : { default: mod }
    }
Object.defineProperty(exports, '__esModule', { value: true })
exports.search = void 0
const jsdom_1 = require('jsdom')
const axios_1 = __importDefault(require('axios'))
const parseTable_1 = __importDefault(require('../helpers/parseTable'))
const search = async (filter, page = 0) => {
    const { data: html } = await axios_1.default.get(
        `https://ncs.io/music-search?page=${page + 1}${
            filter.genre ? `&genre=${filter.genre}` : ''
        }${filter.mood ? `&mood=${filter.mood}` : ''}${filter.search ? `&q=${filter.search}` : ''}${
            filter.version
                ? `&version=${filter.version == 'both' ? 'regular-instrumental' : filter.version}`
                : ''
        }`,
        {
            responseType: 'text'
        }
    )
    const dom = new jsdom_1.JSDOM(html)
    const document = dom.window.document
    const table = document.querySelector('.tablesorter tbody')
    const songs = (0, parseTable_1.default)(table)
    return songs
}
exports.search = search
